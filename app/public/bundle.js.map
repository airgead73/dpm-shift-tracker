{"version":3,"sources":["forms.js","btns.js"],"names":["forms","Array","from","document","querySelectorAll","handleResponse","$data","success","message","relocateTo","alert","window","location","replace","reload","fetchData","$form","attrs","getAttributeNames","reduce","acc","name","getAttribute","options","method","headers","enctype","needsBody","body","formElements","elements","filter","element","hasAttribute","forEach","property","value","JSON","stringify","fetch","action","response","json","data","initForms","$forms","form","addEventListener","event","preventDefault","target","then","length","btns","confirmFetch","$confirmMessage","isConfirmed","confirm","$btn","initBtns","$btns","btn"],"mappings":"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","file":"bundle.js","sourcesContent":["(function() {\n\n  const forms = Array.from(document.querySelectorAll('.form'));\n\n  const handleResponse = ($data) => {\n  \n    const { success, message, relocateTo } = $data;\n  \n    alert(message);\n  \n    if(relocateTo) {\n      window.location.replace(relocateTo); \n    } else {\n      window.location.reload();\n    }\n  \n  }\n  \n  const fetchData = async ($form) => {\n    const attrs = $form.getAttributeNames().reduce((acc, name) => {\n      return {...acc, [name]: $form.getAttribute(name)}\n    }, {});\n  \n    const options = {\n      method: attrs.method,\n      headers: {\n        'Content-Type': attrs.enctype,\n        'Accept': attrs.enctype\n      }\n    }\n  \n    const needsBody = attrs.method === 'POST' || attrs.method === 'PUT';\n   \n    if(needsBody) {\n      let body = {};\n      let formElements = Array.from($form.elements);\n      formElements = formElements.filter(element => {\n        if(element.hasAttribute('name')) {\n          return element;\n        }\n      });\n  \n      formElements.forEach(element => {\n        const property = element.getAttribute('name');\n        const value = $form[property].value;\n        body[property] = value;\n        \n      });\n      \n      options.body = JSON.stringify(body);\n      \n    }\n  \n    const response = await fetch(attrs.action, options);\n    const data = await response.json();\n    \n    data.relocateTo = $form.getAttribute('target') || false;\n  \n    return data;   \n  \n  }\n  \n  const initForms = ($forms) => {\n    $forms.forEach((form) => {\n      form.addEventListener('submit', (event) => {\n        event.preventDefault();\n        fetchData(event.target).then(data => handleResponse(data));\n      });\n      \n    });\n  }\n\n  if(forms.length) {\n    initForms(forms);\n  } else {\n    return;\n  }  \n  \n\n})();\n","(function() {\n\n  const btns = Array.from(document.querySelectorAll('.btn-fetch'));\n\n  const confirmFetch = ($confirmMessage = false) => {\n\n    let isConfirmed = true; \n  \n    if($confirmMessage) isConfirmed = confirm($confirmMessage);  \n  \n    return isConfirmed;\n  \n  }\n\n  const handleResponse = ($data) => {\n    const { success, message, relocateTo } = $data;\n  \n    alert(message);\n  \n    if(relocateTo) {\n      window.location.replace(relocateTo);\n    } else {\n      window.location.reload();\n    }\n  \n  }\n  \n  const fetchData = async ($btn) => {\n  \n    // confirm\n  \n    const isConfirmed = confirmFetch($btn.getAttribute('data-confirm'));\n  \n    if(!isConfirmed) return;\n  \n    // if confirmed, continue\n  \n    const action = $btn.getAttribute('data-action');\n    const method = $btn.getAttribute('data-method');  \n  \n    const options = {\n      method,\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      }\n    }\n  \n    const response = await fetch(action, options);\n    const data = await response.json();\n  \n    return handleResponse(data);\n  \n  }\n  \n  const initBtns = ($btns) => {\n    $btns.forEach((btn) => {\n  \n      btn.addEventListener('click', (event) => {\n        event.preventDefault(); \n        fetchData(event.target);      \n      });\n  \n    });\n  }  \n\n  if(btns.length) {\n    initBtns(btns);\n  } else {\n    return;\n  }\n\n\n})()"]}