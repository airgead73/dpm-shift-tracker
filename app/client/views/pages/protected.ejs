<%- include ('../partials/head') %>

  <header>
    <h1>DPM Shift Tracker</h1>
    <nav>
      <a href="/logout">logout</a>
    </nav>
  </header>

  <main>
    <section>
      <form class="form" id="form_shifts_post" action="/api/shifts" method="POST" enctype="application/json" target="/">
        <fieldset>
          <legend>
            <h2>start a shift</h2>
            <label for="date">
              <input type="datetime-local" id="date" name="date">
            </label>
            <button type="submit">start</button>
          </legend>
        </fieldset>
      </form>
    </section>
    <section>
      <article>
        <h2>current shift</h2>
        <h3><%= date %></h3>
        <p><b>items: </b><%= items %> <b>rate: </b><%= rate %></p>        
      </article>
      <form class="form" id="form_shifts_update" action="/api/shifts/<%= id %>" method="PUT" enctype="application/json"
        target="/">
        <fieldset>
          <legend>
            <h3>add items</h3>
          </legend>
          <input type="number" id="items" name="items">
          <button type="submit">add</button>
        </fieldset>
      </form>
      <form class="form" id="form_shifts_rate" action="/api/shifts/<%= id %>/rate" method="GET"
        enctype="application/json" target="/">
        <fieldset>
          <button type="submit">calculate rate</button>
        </fieldset>
      </form>
      <form class="form" id="form_shifts_delete" action="/api/shifts/<%= id %>" method="DELETE"
        enctype="application/json" target="/">
        <fieldset>
          <button type="submit">delete</button>
        </fieldset>
      </form>      
    </section>
    <section>
      <h2>shift list</h2>
      <table>
        <caption>shift list</caption>
        <thead>
          <tr>
            <th>date</th>
            <th>items</th>
            <th>rate</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <% shifts.forEach(item=> { %>
            <tr>
              <td>
                <%= item.date_formatted %>
              </td>
              <td>
                <%= item.items %>
              </td>
              <td>
                <%= item.rate %>
              </td>
              <td>
                <form class="form" id="form_shifts_delete" action="/api/shifts/<%= id %>" method="DELETE"
                  enctype="application/json" target="/">
                  <button type="submit">delete</button>
                </form>
              </td>
            </tr>
            <% }) %>
        </tbody>
      </table>      
    </section>



  </main>

 

  <%- include('../partials/foot') %>